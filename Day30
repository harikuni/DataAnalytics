######## Problem1 ----->  Friend Requests II: Who Has the Most Friends ###################################
link -----> https://leetcode.com/problems/friend-requests-ii-who-has-the-most-friends/?envType=study-plan-v2&id=top-sql-50

Q. Write an SQL query to find the people who have the most friends and the most friends number.
The test cases are generated so that only one person has the most friends.

select requester_id as id, 
(select count(*) from RequestAccepted where id = requester_id or id = accepter_id) as num
from RequestAccepted
group by 1
order by num desc limit 1




######## Problem2 -----> Investments in 2016 ###################################
link -----> https://leetcode.com/problems/investments-in-2016/?envType=study-plan-v2&id=top-sql-50


Q. Write an SQL query to report the sum of all total investment values in 2016 tiv_2016, for all policyholders who:

have the same tiv_2015 value as one or more other policyholders, and
are not located in the same city like any other policyholder (i.e., the (lat, lon) attribute pairs must be unique).


select round(sum(tiv_2016),2) as tiv_2016 
from (

    select * , count(*) over (partition by tiv_2015) as tiv_2015_cnt,
               count(*) over (partition by lat,lon) as location_cnt
    from insurance
     ) t

where tiv_2015_cnt > 1 and location_cnt = 1
















