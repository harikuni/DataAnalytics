######## Problem1 ----->  International Call Percentage [Verizon SQL Interview Question] ###################################
link -->> https://datalemur.com/questions/international-call-percentage

Q. A phone call is considered an international call when the person calling is in a different country than the person receiving the call.
What percentage of phone calls are international? Round the result to 1 decimal.


SELECT  
  ROUND(
  100.0*SUM(CASE
  WHEN caller.country_id <> receiver.country_id then 1 else NULL end)/
COUNT(*),1) AS perc_calls
FROM phone_calls AS calls
LEFT JOIN phone_info AS caller
  ON calls.caller_id = caller.caller_id
LEFT JOIN phone_info AS receiver
  ON calls.receiver_id = receiver.caller_id;
  
  
######## Problem2 ----->  Y-on-Y Growth Rate [Wayfair SQL Interview Question]###################################
link -->> https://datalemur.com/questions/yoy-growth-rate

Q. ssume you are given the table below containing information on user transactions for particular products. Write a query to obtain the year-on-year growth rate for the total spend of each product for each year.
Output the year (in ascending order) partitioned by product id, current year's spend, previous year's spend and year-on-year growth rate (percentage rounded to 2 decimal places).

with yearly_spend as (
SELECT EXTRACT(year from transaction_date) as year,
product_id,spend as curr_year_spend
from user_transactions 
),

yearly_variance as (
select * ,
LAG(curr_year_spend,1) OVER(
PARTITION BY product_id
ORDER BY product_id,year) as prev_year_spend
from yearly_spend
)

select year,product_id,curr_year_spend,prev_year_spend,
round(100*(curr_year_spend-prev_year_spend)/prev_year_spend,2)
as yoy_rate
from yearly_variance;





















 
